// í‚¤ì›Œë“œ ê¸°ë°˜ ì¶œì œê¸°ì¤€ ë§¤ì¹­ í…ŒìŠ¤íŠ¸

const STANDARD_KEYWORDS = {
  // ì „ê¸°ì´ë¡ 
  "1.1": [
    "ì „í•˜", "ì „ê¸°ì¥", "ì „ìœ„", "ì½˜ë´ì„œ", "ì»¤íŒ¨ì‹œí„°", "ì •ì „ê¸°", "ë„ì²´", "ë¶€ë„ì²´",
    "ì›ì", "ë¶„ì", "ì¿¨ë¡±", "ì „ê¸°ë ¥ì„ ", "ë“±ì „ìœ„ë©´", "ìœ ì „ì²´", "ìœ ì „ìœ¨"
  ],
  "1.2": [
    "ìê¸°", "ìì„", "ìê¸°ì¥", "ìê¸°ë ¥ì„ ", "ìì†", "ìê¸°ì €í•­", "íˆ¬ììœ¨",
    "ì˜êµ¬ìì„", "ì „ìì„", "ìê¸°íšŒë¡œ", "ìê¸°íšŒë¡œë²•ì¹™", "ìê¸°ì¸ë•í„´ìŠ¤"
  ],
  "1.3": [
    "ì „ìë ¥", "ì „ììœ ë„", "ìœ ë„ê¸°ì „ë ¥", "ìƒí˜¸ìœ ë„", "ìì²´ìœ ë„", "ì¸ë•í„´ìŠ¤",
    "ë Œì¸ ì˜ ë²•ì¹™", "í”Œë ˆë°", "ìì†ë°€ë„", "ìì†ì‡„êµìˆ˜"
  ],
  "1.4": [
    "ì§ë¥˜", "ì˜´ì˜ ë²•ì¹™", "ì €í•­", "ì „ì••ê°•í•˜", "ì „ë¥˜", "ì „ì••", "ì „ë ¥",
    "ì§ë ¬", "ë³‘ë ¬", "ì „ìœ„", "í‚¤ë¥´íˆí˜¸í”„", "ì¤‘ì²©ì˜ ì›ë¦¬", "ë“±ê°€ì €í•­"
  ],
  "1.5": [
    "êµë¥˜", "ì •í˜„íŒŒ", "3ìƒ", "RLC", "ì„í”¼ë˜ìŠ¤", "ë¦¬ì•¡í„´ìŠ¤", "ìœ„ìƒ",
    "ì£¼íŒŒìˆ˜", "ê°ì£¼íŒŒìˆ˜", "ì—­ë¥ ", "ìœ íš¨ì „ë ¥", "ë¬´íš¨ì „ë ¥", "í”¼ìƒì „ë ¥",
    "ë¸íƒ€ê²°ì„ ", "ì™€ì´ê²°ì„ ", "ë¹„ì •í˜„íŒŒ", "ê³ ì¡°íŒŒ"
  ],
  "1.6": [
    "ì—´ì‘ìš©", "í™”í•™ì‘ìš©", "ì¤„ì—´", "ì „ë ¥ëŸ‰", "ì „ë ¥", "ì „ì§€", "ì „í•´",
    "ë°œì—´", "í í‹°ì—", "ì§€ë²¡", "ì „ê¸°ë¶„í•´"
  ],
  
  // ì „ê¸°ê¸°ê¸°
  "2.1": [
    "ë³€ì••ê¸°", "ë³€ì••", "ê¶Œìˆ˜ë¹„", "ì „ì••ë¹„", "ì „ë¥˜ë¹„", "ë“±ê°€íšŒë¡œ",
    "3ìƒ ê²°ì„ ", "ë¸íƒ€", "ì™€ì´", "ë³‘ë ¬ìš´ì „", "ë¶€í•˜ìœ¨", "íš¨ìœ¨"
  ],
  "2.2": [
    "ì§ë¥˜ê¸°", "ì§ë¥˜ë°œì „ê¸°", "ì§ë¥˜ì „ë™ê¸°", "ìœ ë„ê¸°ì „ë ¥", "ì „ê¸°ì",
    "ê³„ì", "ê¶Œì„ ", "ì •ë¥˜ì", "ë¸ŒëŸ¬ì‹œ", "ì†ë„ì œì–´", "í† í¬"
  ],
  "2.3": [
    "ìœ ë„ì „ë™ê¸°", "íšŒì „ìê¸°ì¥", "ìŠ¬ë¦½", "ë™ê¸°ì†ë„", "íšŒì „ìˆ˜",
    "3ìƒ ìœ ë„ì „ë™ê¸°", "ë‹¨ìƒ ìœ ë„ì „ë™ê¸°", "ì†ë„ì œì–´", "ê¸°ë™"
  ],
  "2.4": [
    "ë™ê¸°ê¸°", "ë™ê¸°ë°œì „ê¸°", "ë™ê¸°ì „ë™ê¸°", "ë³‘ë ¬ìš´ì „", "ë™ê¸°í™”",
    "ì—¬ì", "ê³„ìì „ë¥˜", "ë™ê¸°ì†ë„", "ë¶€í•˜ê°"
  ],
  "2.5": [
    "ì •ë¥˜ê¸°", "ì •ë¥˜", "ë°˜ë„ì²´", "ë‹¤ì´ì˜¤ë“œ", "ì‚¬ì´ë¦¬ìŠ¤í„°", "íŠ¸ë¼ì´ì•¡",
    "ì œì–´ê¸°", "ì œì–´ì¥ì¹˜", "ì¸ë²„í„°", "ì»¨ë²„í„°"
  ],
  "2.6": [
    "ê³„ì „ê¸°", "ë³´í˜¸ê³„ì „ê¸°", "ê³¼ì „ë¥˜ê³„ì „ê¸°", "ì§€ë½ê³„ì „ê¸°", "ì°¨ë™ê³„ì „ê¸°",
    "ê³„ì „ê¸°", "ë¦´ë ˆì´"
  ],
  
  // ì „ê¸°ì„¤ë¹„
  "3.1": [
    "ë°°ì„ ì¬ë£Œ", "ì „ì„ ", "ì¼€ì´ë¸”", "ë‚˜ì „ì„ ", "ì ˆì—°ì „ì„ ", "ê°œíê¸°",
    "ëˆ„ì „ì°¨ë‹¨ê¸°", "ê³µêµ¬", "ê²Œì´ì§€", "ë°°ì„ ê¸°êµ¬"
  ],
  "3.2": [
    "ì „ì„ ì ‘ì†", "ì ‘ì†", "ë‹¨ì„ ì ‘ì†", "ìŠ¬ë¦¬ë¸Œ", "ê³ ë¦¬í˜•", "ë‹¨ì",
    "í”¼ë³µ", "ë²—ê¸°ê¸°", "ì ‘ì†ë°©ë²•"
  ],
  "3.3": [
    "ë°°ì„ ì„¤ë¹„", "ì „ì„ ê´€", "ì¼€ì´ë¸”íŠ¸ë í‚¹", "ì¼€ì´ë¸”ë•íŒ…", "ì¼€ì´ë¸”íŠ¸ë ˆì´",
    "í—ˆìš©ì „ë¥˜", "ë‹¨ë©´ì ", "ì˜¥ë‚´ë°°ì„ ", "í•©ì„±ìˆ˜ì§€ê´€", "ê¸ˆì†ë•íŠ¸"
  ],
  "3.4": [
    "ë³´ì•ˆê³µì‚¬", "ê³¼ì „ë¥˜", "ì°¨ë‹¨ê¸°", "ì ‘ì§€", "í”¼ë¢°ì„¤ë¹„", "ë³´ì•ˆ",
    "ì „ì„ ë¡œ", "ê¸°ê³„ê¸°êµ¬"
  ],
  "3.5": [
    "ê°€ê³µì¸ì…ì„ ", "ë°°ì „ì„ ", "ì „ì£¼", "ì§€ì§€ë¬¼", "ì• ì", "ê°€ì„ ",
    "ì¸ì…ì„ ", "ë°°ì „ì„ ë¡œ", "ì£¼ìƒê¸°ê¸°"
  ],
  "3.6": [
    "ë°°ì „ë°˜", "ë¶„ì „ë°˜", "ìˆ˜ë³€ì „ì„¤ë¹„", "ê³ ì••", "ì €ì••", "ë°°ì „",
    "ë³€ì „ì†Œ", "ë³€ì „ì‹¤"
  ],
  "3.7": [
    "íŠ¹ìˆ˜ì¥ì†Œ", "ë¨¼ì§€", "ìœ„í—˜ë¬¼", "ê°€ì—°ì„±", "ë¶€ì‹ì„±", "í¥í–‰ì¥",
    "ê´‘ì‚°", "í­ì—°ì„±", "ë¶„ì§„", "í™”ì•½ë¥˜"
  ],
  "3.8": [
    "ì „ê¸°ì‘ìš©", "ì¡°ëª…", "ë™ë ¥", "ì œì–´ë°°ì„ ", "ì‹ í˜¸ë°°ì„ ", "ì‘ìš©ê¸°ê¸°",
    "ì¡°ëª…ë°°ì„ ", "ë™ë ¥ë°°ì„ "
  ],
};

const STANDARDS_BY_CATEGORY = {
  "ì „ê¸°ì´ë¡ ": ["1.1", "1.2", "1.3", "1.4", "1.5", "1.6"],
  "ì „ê¸°ê¸°ê¸°": ["2.1", "2.2", "2.3", "2.4", "2.5", "2.6"],
  "ì „ê¸°ì„¤ë¹„": ["3.1", "3.2", "3.3", "3.4", "3.5", "3.6", "3.7", "3.8"],
};

function matchStandardByKeywords(question, category) {
  // ë¬¸ì œì˜ ëª¨ë“  í…ìŠ¤íŠ¸ë¥¼ í•˜ë‚˜ë¡œ í•©ì¹˜ê¸°
  const fullText = [
    question.question || '',
    question.option1 || '',
    question.option2 || '',
    question.option3 || '',
    question.option4 || '',
    question.explanation || '',
  ].join(' ').toLowerCase();

  // í•´ë‹¹ ì¹´í…Œê³ ë¦¬ì˜ ì¶œì œê¸°ì¤€ë§Œ ê²€ì‚¬
  const standards = STANDARDS_BY_CATEGORY[category] || [];
  if (standards.length === 0) {
    return undefined;
  }

  // ê° ì¶œì œê¸°ì¤€ë³„ë¡œ í‚¤ì›Œë“œ ë§¤ì¹­ ì ìˆ˜ ê³„ì‚°
  const scores = {};
  
  standards.forEach(standard => {
    const keywords = STANDARD_KEYWORDS[standard] || [];
    let score = 0;
    
    keywords.forEach(keyword => {
      const keywordLower = keyword.toLowerCase();
      // ê³µë°± ì œê±°í•œ ë²„ì „ë„ ê²€ì‚¬
      const keywordNoSpace = keywordLower.replace(/\s+/g, '');
      const textNoSpace = fullText.replace(/\s+/g, '');
      
      // í‚¤ì›Œë“œê°€ í…ìŠ¤íŠ¸ì— í¬í•¨ë˜ì–´ ìˆìœ¼ë©´ ì ìˆ˜ ì¦ê°€
      if (fullText.includes(keywordLower) || textNoSpace.includes(keywordNoSpace)) {
        score += 1;
        console.log(`  âœ“ "${keyword}" ë§¤ì¹­ (${standard})`);
      }
    });
    
    if (score > 0) {
      scores[standard] = score;
    }
  });

  // ê°€ì¥ ë†’ì€ ì ìˆ˜ì˜ ì¶œì œê¸°ì¤€ ë°˜í™˜
  const sortedStandards = Object.entries(scores).sort((a, b) => b[1] - a[1]);
  
  console.log('\nğŸ“Š ì¶œì œê¸°ì¤€ë³„ ì ìˆ˜:');
  sortedStandards.forEach(([standard, score]) => {
    console.log(`  ${standard}: ${score}ì `);
  });
  
  if (sortedStandards.length > 0 && sortedStandards[0][1] > 0) {
    return sortedStandards[0][0];
  }

  return undefined;
}

// í…ŒìŠ¤íŠ¸ ë¬¸ì œ
const testQuestion = {
  question: "3ìƒ ìœ ë„ ì „ë™ê¸°ì˜ ì›ì„ ë„ë¥¼ ê·¸ë¦¬ëŠ” ë° í•„ìš”í•˜ì§€ ì•Šì€ ê²ƒì€?",
  option1: "ì •ê²©ì „ì••",
  option2: "ì •ê²©ì „ë¥˜",
  option3: "ì •ê²©ì¶œë ¥",
  option4: "ì •ê²©ì£¼íŒŒìˆ˜",
  explanation: "ì›ì„ ë„ë¥¼ ê·¸ë¦¬ê¸° ìœ„í•´ì„œëŠ” ì •ê²©ì „ì••, ì •ê²©ì „ë¥˜, ì •ê²©ì¶œë ¥ì´ í•„ìš”í•˜ì§€ë§Œ ì •ê²©ì£¼íŒŒìˆ˜ëŠ” í•„ìš”í•˜ì§€ ì•Šë‹¤.",
  category: "ì „ê¸°ê¸°ê¸°"
};

console.log('='.repeat(80));
console.log('ğŸ” í‚¤ì›Œë“œ ê¸°ë°˜ ì¶œì œê¸°ì¤€ ë§¤ì¹­ í…ŒìŠ¤íŠ¸');
console.log('='.repeat(80));
console.log('\në¬¸ì œ:', testQuestion.question);
console.log('ì¹´í…Œê³ ë¦¬:', testQuestion.category);
console.log('\nğŸ“ í‚¤ì›Œë“œ ë§¤ì¹­ ê³¼ì •:');
console.log('='.repeat(80));

const matchedStandard = matchStandardByKeywords(testQuestion, testQuestion.category);

console.log('\n' + '='.repeat(80));
console.log('âœ… ìµœì¢… ê²°ê³¼:');
console.log('='.repeat(80));

if (matchedStandard) {
  const standardTitles = {
    "2.3": "ìœ ë„ì „ë™ê¸°"
  };
  console.log(`\nì¶œì œê¸°ì¤€: ${matchedStandard} - ${standardTitles[matchedStandard] || matchedStandard}`);
  console.log('\nâœ… ì´ ë¬¸ì œëŠ” ìë™ìœ¼ë¡œ "2.3 ìœ ë„ì „ë™ê¸°"ë¡œ ë¶„ë¥˜ë©ë‹ˆë‹¤.');
} else {
  console.log('\nâŒ ë§¤ì¹­ë˜ëŠ” ì¶œì œê¸°ì¤€ì´ ì—†ìŠµë‹ˆë‹¤.');
}

console.log('\nğŸ“Œ ì°¸ê³ :');
console.log('- "3ìƒ" í‚¤ì›Œë“œëŠ” 1.5 êµë¥˜íšŒë¡œì—ë„ ìˆì§€ë§Œ, ì¹´í…Œê³ ë¦¬ëŠ” "ì „ê¸°ê¸°ê¸°"ì´ë¯€ë¡œ');
console.log('  ì „ê¸°ê¸°ê¸° ì¹´í…Œê³ ë¦¬ì˜ ì¶œì œê¸°ì¤€ë§Œ ê²€ì‚¬ë©ë‹ˆë‹¤.');
console.log('- "ìœ ë„ì „ë™ê¸°"ì™€ "3ìƒ ìœ ë„ì „ë™ê¸°" í‚¤ì›Œë“œê°€ 2.3ì— ëª¨ë‘ í¬í•¨ë˜ì–´');
console.log('  ê°€ì¥ ë†’ì€ ì ìˆ˜ë¥¼ ë°›ìŠµë‹ˆë‹¤.');

