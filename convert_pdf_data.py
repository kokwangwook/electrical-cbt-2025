#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
PDF ë¬¸ì œ ë°ì´í„°ë¥¼ Google Sheets TSV í˜•ì‹ìœ¼ë¡œ ë³€í™˜
"""

# 2010ë…„ 4íšŒ ì •ë‹µ
answers_2010_4 = {
    1: 3, 2: 3, 3: 2, 4: 2, 5: 3, 6: 3, 7: 2, 8: 1, 9: 1, 10: 2,
    11: 2, 12: 1, 13: 1, 14: 4, 15: 4, 16: 2, 17: 1, 18: 4, 19: 1, 20: 3,
    21: 3, 22: 1, 23: 3, 24: 4, 25: 1, 26: 4, 27: 2, 28: 3, 29: 1, 30: 2,
    31: 2, 32: 4, 33: 3, 34: 2, 35: 3, 36: 3, 37: 1, 38: 1, 39: 2, 40: 3,
    41: 2, 42: 3, 43: 2, 44: 3, 45: 1, 46: 2, 47: 1, 48: 2, 49: 3, 50: 4,
    51: 1, 52: 3, 53: 4, 54: 4, 55: 1, 56: 4, 57: 2, 58: 2, 59: 1, 60: 4
}

# 2010ë…„ 5íšŒ ì •ë‹µ
answers_2010_5 = {
    1: 2, 2: 2, 3: 1, 4: 3, 5: 3, 6: 4, 7: 2, 8: 1, 9: 1, 10: 3,
    11: 2, 12: 2, 13: 3, 14: 2, 15: 2, 16: 1, 17: 2, 18: 2, 19: 3, 20: 3,
    21: 2, 22: 4, 23: 1, 24: 3, 25: 1, 26: 2, 27: 1, 28: 2, 29: 4, 30: 2,
    31: 3, 32: 3, 33: 1, 34: 3, 35: 3, 36: 3, 37: 3, 38: 3, 39: 2, 40: 1,
    41: 4, 42: 2, 43: 4, 44: 4, 45: 1, 46: 1, 47: 2, 48: 3, 49: 4, 50: 1,
    51: 2, 52: 1, 53: 2, 54: 4, 55: 2, 56: 1, 57: 3, 58: 2, 59: 2, 60: 3
}

# 2010ë…„ 4íšŒ ë¬¸ì œ ë°ì´í„°
questions_2010_4 = [
    {
        "id": 1,
        "question": "ì „ë¥˜ì˜ ë°œì—´ì‘ìš©ì— ê´€í•œ ë²•ì¹™ìœ¼ë¡œ ê°€ì¥ ì•Œë§ì€ ê²ƒì€?",
        "options": ["ì˜´ì˜ ë²•ì¹™", "íŒ¨ëŸ¬ë°ì´ì˜ ë²•ì¹™", "ì¤„ì˜ ë²•ì¹™", "í‚¤ë¥´íˆí˜¸í”„ì˜ ë²•ì¹™"],
        "explanation": "ë„ì„ ì— ì „ë¥˜ê°€ íë¥´ë©´ ì—´ì´ ë°œìƒí•œë‹¤ - ì¤„ì˜ë²•ì¹™"
    },
    {
        "id": 2,
        "question": "1ãŒ, 3ãŒ, 6ãŒì˜ ì½˜ë´ì„œ 3ê°œë¥¼ ë³‘ë ¬ë¡œ ì—°ê²°í•  ë•Œ í•©ì„± ì •ì „ìš©ëŸ‰?",
        "options": ["1.5ãŒ", "5ãŒ", "10ãŒ", "18ãŒ"],
        "explanation": "ì½˜ë´ì„œëŠ” ë³‘ë ¬ë¡œ ì—°ê²°ë˜ì–´ ìˆìœ¼ë©´ ê·¸ ê°’ì„ ëª¨ë‘ ë”í•œë‹¤. C=C1+C2+C3=1+3+6=10ãŒ"
    },
    {
        "id": 3,
        "question": "R-L ì§ë ¬íšŒë¡œì˜ ì‹œì •ìˆ˜ Ï„[s]ëŠ”?",
        "options": ["L/R [s]", "R/L [s]", "RL[s]", "1/RL [s]"],
        "explanation": "RL ì§ë ¬íšŒë¡œì˜ ì‹œì •ìˆ˜ëŠ” Ï„=L/R [sec]"
    },
    {
        "id": 4,
        "question": "ì „ê¸°ì €í•­ 25Î©ì— 50Vì˜ ì‚¬ì¸íŒŒ ì „ì••ì„ ê°€í•  ë•Œ ì „ë¥˜ì˜ ìˆœì‹œê°’ì€? (ë‹¨, ê°ì†ë„ Ï‰=377[rad/sec]ì„)",
        "options": ["2sin377t[A]", "2âˆš2 sin377t[A]", "4sin377t[A]", "4âˆš2 sin377t[A]"],
        "explanation": "I=V/Z=50âˆš2 sin377t/25=2âˆš2 sin377t[A]"
    },
    {
        "id": 5,
        "question": "1.5Vì˜ ì „ìœ„ì°¨ë¡œ 3Aì˜ ì „ë¥˜ê°€ 3ë¶„ ë™ì•ˆ í˜ë €ì„ ë•Œ í•œ ì¼ì€?",
        "options": ["1.5[J]", "13.5[J]", "810[J]", "2430[J]"],
        "explanation": "í•œì¼=í˜*ì‹œê°„, W=Pt=1.5*3*3*60=810[J]"
    }
]

# 2010ë…„ 5íšŒ ë¬¸ì œ ë°ì´í„°
questions_2010_5 = [
    {
        "id": 1,
        "question": "ìì²´ ì¸ë•í„´ìŠ¤ê°€ 40mHì™€ 90mHì¸ ë‘ ê°œì˜ ì½”ì¼ì´ ìˆë‹¤. ë‘ ì½”ì¼ ì‚¬ì´ì— ëˆ„ì„¤ìì†ì´ ì—†ë‹¤ê³  í•˜ë©´ ìƒí˜¸ ì¸ë•í„´ìŠ¤ëŠ”?",
        "options": ["50[mH]", "60[mH]", "65[mH]", "130[mH]"],
        "explanation": ""
    },
    {
        "id": 2,
        "question": "R-L ì§ë ¬íšŒë¡œì—ì„œ R=20[Î©], L=10[H]ì¸ ê²½ìš° ì‹œì •ìˆ˜ Ï„ëŠ”?",
        "options": ["0.005[s]", "0.5[s]", "2[s]", "200[s]"],
        "explanation": ""
    },
    {
        "id": 3,
        "question": "ë‘ ê¸ˆì†ì„ ì ‘ì†í•˜ì—¬ ì—¬ê¸°ì— ì „ë¥˜ë¥¼ í†µí•˜ë©´, ì¤„ì—´ ì™¸ì— ê·¸ ì ‘ì ì—ì„œ ì—´ì˜ ë°œìƒ ë˜ëŠ” í¡ìˆ˜ê°€ ì¼ì–´ë‚˜ëŠ” í˜„ìƒì€?",
        "options": ["í í‹°ì— íš¨ê³¼", "ì§€ë²¡ íš¨ê³¼", "í™€ íš¨ê³¼", "ì¤„ íš¨ê³¼"],
        "explanation": ""
    },
    {
        "id": 4,
        "question": "ë“±ì „ìœ„ë©´ê³¼ ì „ê¸°ë ¥ì„ ì˜ êµì°¨ ê´€ê³„ëŠ”?",
        "options": ["30Â°ë¡œ êµì°¨í•œë‹¤.", "45Â°ë¡œ êµì°¨í•œë‹¤.", "ì§ê°ìœ¼ë¡œ êµì°¨í•œë‹¤.", "êµì°¨í•˜ì§€ ì•ŠëŠ”ë‹¤."],
        "explanation": ""
    },
    {
        "id": 5,
        "question": "ìê¸°ì €í•­ì˜ ë‹¨ìœ„ëŠ”?",
        "options": ["[AT/m]", "[Wb/AT]", "[AT/Wb]", "[Î©/AT]"],
        "explanation": ""
    }
]

def create_tsv_row(year, exam_num, q_data, answer, category="ì „ê¸°ì´ë¡ "):
    """TSV í–‰ ìƒì„±"""
    q_id = (year - 2010) * 1000 + exam_num * 100 + q_data["id"]
    question = q_data["question"]
    options = q_data["options"]
    explanation = q_data.get("explanation", "")

    return f"{q_id}\t{category}\t{question}\t{options[0]}\t{options[1]}\t{options[2]}\t{options[3]}\t{answer}\t{explanation}\t"

def main():
    """ë©”ì¸ í•¨ìˆ˜"""
    print("PDF ë¬¸ì œ ë°ì´í„° ë³€í™˜ ì¤‘...")

    output_file = "D:/cbt/electrical-cbt/converted_questions.tsv"

    with open(output_file, "w", encoding="utf-8") as f:
        # í—¤ë” ì‘ì„±
        f.write("id\tcategory\tquestion\toption1\toption2\toption3\toption4\tanswer\texplanation\timageUrl\n")

        # 2010ë…„ 4íšŒ (ìƒ˜í”Œ 5ë¬¸ì œë§Œ)
        for q in questions_2010_4:
            answer = answers_2010_4[q["id"]]
            row = create_tsv_row(2010, 4, q, answer)
            f.write(row + "\n")

        # 2010ë…„ 5íšŒ (ìƒ˜í”Œ 5ë¬¸ì œë§Œ)
        for q in questions_2010_5:
            answer = answers_2010_5[q["id"]]
            row = create_tsv_row(2010, 5, q, answer)
            f.write(row + "\n")

    print(f"âœ… ë³€í™˜ ì™„ë£Œ! íŒŒì¼ ì €ì¥: {output_file}")
    print(f"ğŸ“Š ì´ {len(questions_2010_4) + len(questions_2010_5)}ê°œ ë¬¸ì œ ë³€í™˜")

if __name__ == "__main__":
    main()
